rules_version='2'

service cloud.firestore {
  match /databases/{database}/documents {
    // Users collection - users can read all users, but only update their own
    match /users/{userId} {
      allow read: if true;
      allow create: if true;
      allow update: if true;
    }
    
    // Messages collection - all users can read and create
    match /messages/{messageId} {
      allow read: if true;
      allow create: if true;
      allow update: if true;
    }
    
    // Votes collection - users can create/update/delete their own votes
    match /votes/{voteId} {
      allow read: if true;
      allow create, update, delete: if true;
    }
    
    // Reactions collection - users can create/delete their own reactions
    match /reactions/{reactionId} {
      allow read: if true;
      allow create, delete: if true;
    }
    
    // Reports collection - users can create reports, admins can read all
    match /reports/{reportId} {
      allow read: if true; // Allow reading for admin purposes
      allow create: if true; // Allow authenticated users to create reports
    }
    
    // Announcements collection - read-only for users
    match /announcements/{announcementId} {
      allow read: if true;
      allow write: if true; // Allow for testing
    }
    
    // User preferences - users can read/write their own preferences
    match /userPreferences/{userId} {
      allow read, write: if true;
    }
  }
}
